<!DOCTYPE html>
<html>

<head>
    <?!= include("front/page/head"); ?>
    <?!= include("front/css/pageCss"); ?>
    <?!= include("front/css/mainCss"); ?>
    <?!= includeWithArgs("front/page/nav", {mail: mail, key: key, url: url, fullName: fullName, admin: admin, testing: testing, page: "compo"}); ?>
</head>

<body>
<div class="container">
    <div class="row"></div>
    <div class="row">
        <?if(!cancelMatch) {?>
        <h3 class="title">Composition pour le match <?=date?></h3>
        <?} else {?>
        <h3 class="alert">Match <?=date?> annulé</h3>
        <?}?>
    </div>
    <?!= includeWithArgs("front/utils/stadiumInfo", {stadium: stadium, withDetail: false}) ?>
    <div class="row">
        <div class="col s12 m8 offset-m2 l6 offset-l3 xl4 offset-xl4">
            <div class="field">
                <div class="zone1 valign-wrapper">
                    <div class="joueur red z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[0]?>'>
                        <?= compoNickName[0] ?><? if(confirmations[0] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                    </div>
                </div>
                <div class="zone2">
                    <div class="zoneGauche valign-wrapper">
                        <div class="joueur red z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[1]?>'>
                            <?= compoNickName[1] ?><? if(confirmations[1] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                        </div>
                    </div>
                    <div class="zoneDroite valign-wrapper">
                        <div class="joueur red z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[2]?>'>
                            <?= compoNickName[2] ?><? if(confirmations[2] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                        </div>
                    </div>
                </div>
                <div class="zone2">
                    <div class="zoneGauche valign-wrapper">
                        <div class="joueur red z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[3]?>'>
                            <?= compoNickName[3] ?><? if(confirmations[3] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                        </div>
                    </div>
                    <div class="zoneDroite valign-wrapper">
                        <div class="joueur red z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[4]?>'>
                            <?= compoNickName[4] ?><? if(confirmations[4] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                        </div>
                    </div>
                </div>
                <div class="zone2">
                    <div class="zoneGauche valign-wrapper">
                        <div class="joueur blue z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[5]?>'>
                            <?= compoNickName[5] ?><? if(confirmations[5] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                        </div>
                    </div>
                    <div class="zoneDroite valign-wrapper">
                        <div class="joueur blue z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[6]?>'>
                            <?= compoNickName[6] ?><? if(confirmations[6] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                        </div>
                    </div>
                </div>
                <div class="zone2">
                    <div class="zoneGauche valign-wrapper">
                        <div class="joueur blue z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[7]?>'>
                            <?= compoNickName[7] ?><? if(confirmations[7] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                        </div>
                    </div>
                    <div class="zoneDroite valign-wrapper">
                        <div class="joueur blue z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[8]?>'>
                            <?= compoNickName[8] ?><? if(confirmations[8] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                        </div>
                    </div>
                </div>
                <div class="zone1 valign-wrapper">
                    <div class="joueur blue z-depth-3 tooltipped" data-tooltip='<?!=compoFullName[9]?>'>
                        <?= compoNickName[9] ?><? if(confirmations[9] == "Oui") { ?> <i class='tiny material-icons'>check</i><? } ?>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <? if(buttonStatus.type == "inscription" && !cancelMatch) { ?>
    <div class="row">
        <div class="input-field col s6 l2 offset-l4">
            <a id="inscription" <? if(buttonStatus.status == "Oui") { ?> class="buttonGray" <? } else { ?> class="buttonGreen" onclick="inscriptionJs()" <? } ?>>Je suis dispo</a>
        </div>
        <div class="input-field col s6 l2">
            <a id="desinscription" <? if(buttonStatus.status == "Non") { ?> class="buttonGray" <? } else { ?> class="buttonRed" onclick="desinscriptionJs()" <? } ?>>Je suis pas dispo</a>
        </div>
    </div>
    <? } else if(buttonStatus.type == "confirmation" && !cancelMatch) { ?>
    <div class="row">
        <div class="input-field col s3">
            <a <? if(buttonStatus.status == "alone") { ?> class="buttonGray" <? } else { ?> class="buttonGreen" onclick="confirmationJs('alone')" <? } ?>>
                Je viens seul<div class="logoCarAloneWhite"></div>
            </a>
        </div>
        <div class="input-field col s3">
            <a <? if(buttonStatus.status == "sharing") { ?> class="buttonGray" <? } else { ?> class="buttonGreen" onclick="confirmationJs('sharing')" <? } ?>>
                J'ai de la place dans ma voiture<div class="logoCarSharingWhite"></div>
            </a>
        </div>
        <div class="input-field col s3">
            <a <? if(buttonStatus.status == "need") { ?> class="buttonGray" <? } else { ?> class="buttonGreen" onclick="confirmationJs('need')" <? } ?>>
                J'ai besoin d'un chauffeur<div class="logoCarNeedWhite"></div>
            </a>
        </div>
        <div class="input-field col s3">
            <a <? if(buttonStatus.status == "") { ?> class="buttonGray" <? } else { ?> class="buttonRed valign-wrapper" onclick="desinscriptionJs()" <? } ?>>
            Je ne suis pas dispo<br><i class='material-icons' style='font-size: 34px'>cancel</i>
            </a>
        </div>
    </div>
    <? } ?>

    <? if (effectif != "" || listeAttente != "" ||listePasDispo != "" || listePasRepondu != "" || listePasInvite != "" || listeBlesse != "" || forum != "") { ?>
    <div class="row">
        <div class="col s12">
            <ul class="collapsible expandable">
                <? if(forum != "") { ?>
                <li class="active">
                    <div class="collapsible-header"><span class="text-align-center">Message</span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center"><?!=forum?></div>
                </li>
                <? } ?>
                <? if (effectif != "") { ?>
                <li class="active">
                    <div class="collapsible-header"><span class="text-align-center">Composition</span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center">
                        <div class="row">
                            <table id="equipes" class="centered striped">
                                <thead>
                                <tr>
                                    <th onclick="sortTableCompo(0)" style="cursor:pointer">Joueur</th>
                                    <th onclick="sortTableCompo(1)" style="cursor:pointer">Surnom</th>
                                    <th onclick="sortTableCompo(2)" style="cursor:pointer">Classement</th>
                                    <? if(admin) { ?>
                                    <th onclick="sortTableCompo(3)" style="cursor:pointer">Poste</th>
                                    <th onclick="sortTableCompo(4)" style="cursor:pointer">Niv : Dri/Fra/Def</th>
                                    <th onclick="sortTableCompo(5)" style="cursor:pointer">Série en cours</th>
                                    <th onclick="sortTableCompo(6)" style="cursor:pointer">Site</th>
                                    <th onclick="sortTableCompo(7)" style="cursor:pointer">Covoiturage</th>
                                    <th>Confirmation</th>
                                    <th>Changement</th>
                                    <? } else { ?>
                                    <th onclick="sortTableCompo(3)" style="cursor:pointer">Série en cours</th>
                                    <th onclick="sortTableCompo(4)" style="cursor:pointer">Site</th>
                                    <th onclick="sortTableCompo(5)" style="cursor:pointer">Covoiturage</th>
                                    <? } ?>
                                </tr>
                                </thead>
                                <tbody>
                                <?!=effectif?>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </li>
                <? } ?>

                <? if(niveauEquipe != "") { ?>
                <li>
                    <div class="collapsible-header"><span class="text-align-center">Niveau équipe</span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center">
                        <div class="text-align-center">
                            <table id="level" class="centered striped">
                                <thead>
                                <tr>
                                    <th>Niveau</th>
                                    <th>Rouge</th>
                                    <th>Bleu</th>
                                </tr>
                                </thead>
                                <tbody>
                                <?!=niveauEquipe?>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </li>
                <? } ?>

                <? if(listeAttente != "") { ?>
                <li>
                    <div class="collapsible-header"><span class="text-align-center">
                        <? if((listeAttente.split('<br>').length - 1) == 1) { ?>Joueur en attente<? } else { ?>Joueurs en attente<? } ?>
                    </span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center"><?!=listeAttente?></div>
                </li>
                <? } ?>

                <? if(listePasDispo != "") { ?>
                <li>
                    <div class="collapsible-header"><span class="text-align-center">
                        <? if((listePasDispo.split('<br>').length - 1) == 1) { ?>Joueur pas dispo (réponse)<? } else { ?>Joueurs pas dispo (réponse)<? } ?>
                    </span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center"><?!=listePasDispo?></div>
                </li>
                <? } ?>

                <? if(listePasDispoJour != "") { ?>
                <li>
                    <div class="collapsible-header"><span class="text-align-center">
                        <? if((listePasDispoJour.split('<br>').length - 1) == 1) { ?>Joueur pas dispo (jour)<? } else { ?>Joueurs pas dispo (jour)<? } ?>
                    </span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center"><?!=listePasDispoJour?></div>
                </li>
                <? } ?>

                <? if(listePasRepondu != "") { ?>
                <li>
                    <div class="collapsible-header"><span class="text-align-center">
                        <? if((listePasRepondu.split('<br>').length - 1) == 1) { ?>Joueur sans réponse<? } else { ?>Joueurs sans réponse<? } ?>
                    </span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center"><?!=listePasRepondu?></div>
                </li>
                <? } ?>

                <? if(listePasInvite != "") { ?>
                <li>
                    <div class="collapsible-header"><span class="text-align-center">
                        <? if((listePasInvite.split('<br>').length - 1) == 1) { ?>Joueur pas invité<? } else { ?>Joueurs pas invités<? } ?>
                    </span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center"><?!=listePasInvite?></div>
                </li>
                <? } ?>

                <? if(listeBlesse != "") { ?>
                <li>
                    <div class="collapsible-header"><span class="text-align-center">
                        <? if((listeBlesse.split('<br>').length - 1) == 1) { ?>Joueur blessé<? } else { ?>Joueurs blessés<? } ?>
                    </span><i class="material-icons tiny rotate">arrow_drop_down</i></div>
                    <div class="collapsible-body text-align-center"><?!=listeBlesse?></div>
                </li>
                <? } ?>
            </ul>
        </div>
    </div>
    <? } ?>
</div>

<? if(mail) { ?>
<div class="fixed-action-btn direction-top active" style="bottom: 175px; right: 25px;">
    <a class="btn-floating btn-large waves-effect waves-light green lighten-2 tooltipped" data-tooltip="Activer/Désactiver le rafraichissement automatique"
    <? if(refreshAutoMiliSecond && Number(refreshAutoMiliSecond) > 0) { ?>
        onclick="reloadNav()"><i class="material-icons">clear</i>
    <? } else { ?>
        onclick="refreshCompoPageAuto()"><i class="material-icons">autorenew</i>
    <? } ?>
    </a>
</div>

<div class="fixed-action-btn direction-top active" style="bottom: 100px; right: 25px;">
    <a data-target="messageForumModal" class="btn-floating btn-large waves-effect waves-light modal-trigger green lighten-2 tooltipped" data-tooltip="Envoyer un message aux joueurs inscrits">
        <i class="material-icons">email</i>
    </a>
</div>
<div id="messageForumModal" class="modal">
    <div class="modal-content">
        <h5>Envoyer un message aux joueurs inscris</h5>
        <div class="container">
            <label for="messageForum">message :</label>
            <textarea id="messageForum" class="materialize-textarea"></textarea>
            <a class="buttonGreen modal-close" onclick="envoyerMessageForumJs()">Envoyer</a>
        </div>
    </div>
</div>
<? } ?>

<div class="fixed-action-btn direction-top active" style="bottom: 25px; right: 25px;">
    <a data-target="helper" class="btn-floating btn-large waves-effect waves-light modal-trigger green lighten-2"><i class="material-icons">help_outline</i></a>
</div>
<div id="helper" class="modal">
    <div class="modal-content">
        <h5>Inscriptions</h5>
        <p>Les inscriptions sont envoyées par vague :
            <br>1ère vague : les prioritaires
            <br>2ème vague : les habitués
            <br>3ème vague : les joueurs occasionnels
            <br>4ème vague : les joueurs venant rarement
            <br>Les vagues 3 et 4 ne sont envoyées que s'il reste de la place
            <br>La composition est créée la veille du match (17h)
            <br>Une confirmation de présence est demandée le matin du match
        </p>
        <h5>Priorisation / Composition</h5>
        <p>Les joueurs sont choisis par l'ordre d'inscription
            <br>Les joueurs en liste d'attente seront prioritaire
            <br>Les joueurs qui jouent perdent leur priorité
        </p>
        <h5>Nos règles</h5>
        <p>Le gardien reste dans sa zone
            <br>Les joueurs ne rentrent pas dans la zone du gardien
            <br>Filets arrières => Sortie de but. Balle au gardien
            <br>Filets latéraux => Ça joue
            <br>Filet haut => On perd la balle. Balle au gardien
            <br>Un homme à terre, on stoppe le jeu
            <br>On ne s'accroche pas au filet
        </p>
        <h5>Composition</h5>
        <p>La composition est faite automatiquement selon les niveaux des joueurs
            <br>Pour mettre à jour tes niveaux va sur la page Profil
        </p>
    </div>
</div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
<?!= include("front/js/compo-js"); ?>
<?!= include("front/js/nav-js"); ?>
<!--<?!= include("front/js/christmas-js"); ?>-->
</html>